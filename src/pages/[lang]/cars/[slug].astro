---
import Layout from '../../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { useTranslations } from '../../../i18n/ui';
import { MessageCircle, ArrowLeft } from 'lucide-react';

export async function getStaticPaths() {
  const cars = await getCollection('cars');
  const paths = [];
  ['en', 'te', 'hi'].forEach(lang => {
    cars.forEach(car => {
      paths.push({ 
        params: { lang, slug: car.slug }, 
        props: { car } 
      });
    });
  });
  return paths;
}

const { lang } = Astro.params;
const { car } = Astro.props;
const { Content } = await car.render();
const t = useTranslations(lang as any);
---

<Layout title={`${car.data.name} | Prakash Hyundai`} lang={lang}>
  <div class="min-h-screen bg-gradient-to-b from-[#F5F6F7] to-white">
    <!-- Back Button -->
    <div class="container mx-auto px-6 pt-8">
      <a href={`/${lang}#cars`} class="inline-flex items-center gap-2 text-[#002C5F] hover:text-[#00AAD2] font-medium transition-colors">
        <ArrowLeft size={20} />
        {t('nav.cars')}
      </a>
    </div>

    <!-- Hero Section -->
    <section class="container mx-auto px-6 py-12">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <div class="space-y-6">
          <div class="inline-block px-4 py-2 bg-blue-50 text-[#002C5F] rounded-full font-bold text-sm uppercase tracking-wider border border-blue-100">
            {car.data.category}
          </div>
          <h1 class="text-5xl lg:text-6xl font-bold text-[#1C1C1C] leading-tight">
            {car.data.name}
          </h1>
          <p class="text-2xl text-gray-600 italic">
            "{car.data.tagline}"
          </p>
          <div class="flex items-baseline gap-2">
            <span class="text-sm text-gray-500 uppercase font-semibold">Starting From</span>
            <span class="text-3xl font-bold text-[#002C5F]">{car.data.price}</span>
          </div>
          <div class="flex gap-4 pt-4">
            <a href={`https://wa.me/15557728717?text=I'm interested in ${car.data.name}. Can you provide more details?`} 
               class="flex items-center gap-2 bg-[#002C5F] text-white px-8 py-4 rounded-xl font-bold hover:bg-[#001f42] transition-all shadow-xl shadow-blue-900/20 group">
              <MessageCircle size={20} class="group-hover:scale-110 transition-transform"/>
              {t('hero.cta')}
            </a>
          </div>
        </div>
        
        <div class="relative">
          <div class="relative z-10 rounded-3xl overflow-hidden shadow-2xl">
            <img src={car.data.image} alt={car.data.name} class="w-full h-auto object-cover" />
          </div>
        </div>
      </div>
    </section>

    <!-- Features Section -->
    {car.data.features && car.data.features.length > 0 && (
      <section class="container mx-auto px-6 py-12">
        <div class="bg-white rounded-3xl p-8 shadow-lg border border-gray-100">
          <h2 class="text-3xl font-bold text-[#1C1C1C] mb-8">Key Features</h2>
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            {car.data.features.map((feature) => (
              <div class="flex items-start gap-3">
                <div class="w-2 h-2 bg-[#00AAD2] rounded-full mt-2 flex-shrink-0"></div>
                <p class="text-gray-700 leading-relaxed">{feature}</p>
              </div>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- Content Section -->
    <section class="container mx-auto px-6 py-12 pb-20">
      <div class="bg-white rounded-3xl p-8 lg:p-12 shadow-lg border border-gray-100">
        <div class="prose prose-lg prose-blue max-w-none prose-headings:font-bold prose-headings:text-[#002C5F] prose-a:text-[#00AAD2] prose-ul:text-gray-700 prose-p:text-gray-700">
          <Content />
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="container mx-auto px-6 pb-20">
      <div class="bg-gradient-to-r from-[#002C5F] to-[#00AAD2] rounded-3xl p-12 text-center text-white">
        <h2 class="text-3xl font-bold mb-4">Interested in {car.data.name}?</h2>
        <p class="text-xl mb-8 text-blue-100">Contact us today for a test drive and best price quote!</p>
        <a href={`https://wa.me/15557728717?text=I'm interested in ${car.data.name}. Can you arrange a test drive?`} 
           class="inline-flex items-center gap-2 bg-white text-[#002C5F] px-8 py-4 rounded-xl font-bold hover:bg-gray-100 transition-all shadow-xl">
          <MessageCircle size={20} />
          Request Test Drive
        </a>
      </div>
    </section>
  </div>
</Layout>
